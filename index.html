<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Salt Whisperer</title>
<style>
:root{
 --bgA:#0b1220;--bgB:#14244b;--card:#fff;--text:#0f172a;
 --high:#dc2626;--mod:#f59e0b;--low:#16a34a;--smart:#22c55e;
 --radius:26px;--shadow:0 18px 50px rgba(0,0,0,.35);
}
body{margin:0;font-family:system-ui;background:linear-gradient(135deg,var(--bgA),var(--bgB));color:#e5e7eb;overflow:hidden}
.app{max-width:560px;margin:auto;height:100dvh;display:flex;flex-direction:column;padding:14px;gap:10px}
header{display:flex;justify-content:space-between}
.logo{width:42px;height:42px;border-radius:14px;background:linear-gradient(135deg,#60a5fa,#a78bfa);display:grid;place-items:center;font-weight:900}
h1{margin:0;font-size:18px}
.sub{font-size:12px;opacity:.85}
.hud{font-size:12px;text-align:right}
.progress{height:10px;background:rgba(255,255,255,.15);border-radius:999px;overflow:hidden}
.progress div{height:100%;width:0%;background:linear-gradient(90deg,#60a5fa,#a78bfa)}
.stack{flex:1;position:relative}
.card{position:absolute;inset:0;background:var(--card);color:var(--text);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;display:flex;flex-direction:column;justify-content:space-between}
.badge{font-size:11px;font-weight:900;padding:6px 10px;border-radius:999px}
.smart{background:rgba(34,197,94,.15);color:#065f46}
.center{text-align:center}
.emoji{font-size:64px}
.name{font-size:24px;font-weight:900}
.prompt{font-size:14px;color:#475569}
.part{background:#f1f5f9;border-radius:14px;padding:8px 10px;margin-bottom:6px;font-size:14px}
.controls{display:flex;gap:10px}
button{flex:1;border:0;border-radius:999px;padding:14px;font-weight:900}
.high{background:rgba(220,38,38,.15);color:#fecaca}
.mod{background:rgba(245,158,11,.15);color:#fde68a}
.low{background:rgba(22,163,74,.15);color:#bbf7d0}
.toast{background:rgba(2,6,23,.7);border-radius:18px;padding:14px;font-size:13px;display:none}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
.panel{background:rgba(15,23,42,.95);padding:22px;border-radius:26px;max-width:420px;text-align:center}
.toggleRow{display:flex;gap:6px;flex-wrap:wrap}
.toggle{padding:6px 10px;border-radius:999px;font-size:11px;border:1px solid rgba(255,255,255,.3);cursor:pointer}
.toggle.on{background:#22c55e;color:#052e16;border-color:#22c55e}
.footer{font-size:11px;opacity:.75;text-align:center}
</style>
</head>
<body>
<div class="app">
<header>
 <div style="display:flex;gap:10px">
  <div class="logo">ğŸ§‚</div>
  <div>
    <h1>Salt Whisperer</h1>
    <div class="sub">Rookie â†’ Whisperer â†’ Specialist â†’ Master â†’ Guru</div>
  </div>
 </div>
 <div class="hud">
   Level <b id="level">1</b>/5<br/>
   <span id="rank">Rookie</span><br/>
   Card <b id="cardN">1</b>/10
 </div>
</header>

<div class="toggleRow">
 <div class="toggle on" data-c="all">All</div>
 <div class="toggle on" data-c="american">American</div>
 <div class="toggle on" data-c="asian">Asian</div>
 <div class="toggle on" data-c="indian">Indian</div>
 <div class="toggle on" data-c="med">Mediterranean</div>
</div>

<div class="progress"><div id="prog"></div></div>
<div class="stack" id="stack"></div>

<div class="controls">
 <button class="high" onclick="answer('high')">â¬… High</button>
 <button class="mod" onclick="answer('mod')">â¬† Moderate</button>
 <button class="low" onclick="answer('low')">Low â¡</button>
</div>

<div class="toast" id="toast"></div>
<div class="footer">Educational only â€¢ Brands & recipes vary</div>
</div>

<div class="modal" id="modal"><div class="panel" id="panel"></div></div>

<script>
const FEEDBACK=3000, PASS=7;
const RANKS=["Rookie","Whisperer","Specialist","Master","Guru"];
let level=1, idx=0, correct=0, busy=false;
let cuisines={all:true,american:true,asian:true,indian:true,med:true};

const FOODS=[
 {n:"Eggs",e:"ğŸ³",c:"low",t:"Naturally low sodium."},
 {n:"Bread",e:"ğŸ",c:"mod",t:"Hidden sodium in dough."},
 {n:"Bagel",e:"ğŸ¥¯",c:"high",t:"Dense breads carry more salt."},
 {n:"Rice",e:"ğŸš",c:"low",t:"Plain rice is low sodium."},
 {n:"Deli Meat",e:"ğŸ¥ª",c:"high",t:"Processed meats are salty."},
 {n:"Soup",e:"ğŸ¥«",c:"high",t:"Liquid foods hide salt."},
 {n:"Cheese",e:"ğŸ§€",c:"mod",t:"Salt is part of cheese."}
];

const MEALS=[
 // American
 {n:"Grilled Chicken Plate",e:"ğŸ—",c:"low",s:true,cu:"american",p:["Chicken","Rice","Veg"],t:"Repeatable low-sodium dinner."},
 {n:"Burger & Fries",e:"ğŸ”",c:"high",cu:"american",p:["Burger","Fries"],t:"Sides drive sodium."},
 {n:"Breakfast-for-Dinner",e:"ğŸ³",c:"mod",cu:"american",p:["Eggs","Toast","Fruit"],t:"Bread pushes sodium."},
 {n:"BBQ Plate",e:"ğŸ–",c:"high",cu:"american",p:["Ribs","Sauce"],t:"Sauce carries salt."},
 // Asian
 {n:"Teriyaki Bowl",e:"ğŸœ",c:"high",cu:"asian",p:["Chicken","Sauce","Rice"],t:"Sauce is the culprit."},
 {n:"Stir Fry (Low-sodium)",e:"ğŸ¥¦",c:"mod",s:true,cu:"asian",p:["Veg","Protein"],t:"Light sauce keeps sodium down."},
 {n:"Pho (Less Broth)",e:"ğŸœ",c:"mod",s:true,cu:"asian",p:["Noodles","Herbs"],t:"Broth control matters."},
 {n:"Ramen Bowl",e:"ğŸœ",c:"high",cu:"asian",p:["Noodles","Broth"],t:"Most salt is in broth."},
 // Indian
 {n:"Dal & Rice",e:"ğŸ¥£",c:"low",s:true,cu:"indian",p:["Dal","Rice"],t:"Spices without salt."},
 {n:"Butter Chicken",e:"ğŸ›",c:"high",cu:"indian",p:["Sauce","Naan"],t:"Restaurant sauces add salt."},
 {n:"Chana Masala",e:"ğŸ²",c:"mod",cu:"indian",p:["Chickpeas","Spices"],t:"Salt varies by prep."},
 {n:"Biryani",e:"ğŸ›",c:"mod",cu:"indian",p:["Rice","Spices"],t:"Portion matters."},
 // Mediterranean
 {n:"Mediterranean Bowl",e:"ğŸ¥—",c:"mod",s:true,cu:"med",p:["Chicken","Veg","Tzatziki"],t:"Sauce on side helps."},
 {n:"Grilled Fish Plate",e:"ğŸŸ",c:"low",s:true,cu:"med",p:["Fish","Potatoes","Salad"],t:"Simple prep keeps sodium low."},
 {n:"Gyro Plate",e:"ğŸ¥™",c:"high",cu:"med",p:["Meat","Sauce"],t:"Processed meat adds salt."},
 {n:"Hummus & Pita",e:"ğŸ«“",c:"mod",cu:"med",p:["Hummus","Bread"],t:"Bread + dip stack sodium."}
];

// duplicate meals to exceed 40
while(MEALS.length<42){MEALS.push(JSON.parse(JSON.stringify(MEALS[MEALS.length%14])));}

const stack=document.getElementById("stack");
const toast=document.getElementById("toast");
const modal=document.getElementById("modal");
const panel=document.getElementById("panel");

function shuffle(a){return [...a].sort(()=>Math.random()-.5);}
function activeMeals(){
 if(cuisines.all) return MEALS;
 return MEALS.filter(m=>cuisines[m.cu]);
}

function buildRound(){
 const foods=shuffle(FOODS).slice(0,7).map(f=>({type:"food",...f}));
 const mealPool=activeMeals();
 const smart=shuffle(mealPool.filter(m=>m.s)).slice(0,1);
 const others=shuffle(mealPool.filter(m=>!m.s)).slice(0,2);
 return shuffle([...foods,...smart.map(m=>({type:"meal",...m})),...others.map(m=>({type:"meal",...m}))]);
}

function render(){
 stack.innerHTML=""; toast.style.display="none";
 const c=round[idx];
 document.getElementById("level").textContent=level;
 document.getElementById("rank").textContent=RANKS[level-1];
 document.getElementById("cardN").textContent=idx+1;
 document.getElementById("prog").style.width=(idx/10*100)+"%";
 const el=document.createElement("div");
 el.className="card";
 el.innerHTML=`
  <div style="display:flex;justify-content:space-between">
   <div class="badge">${c.type}</div>${c.s?'<div class="badge smart">SMART</div>':''}
  </div>
  <div class="center">
   <div class="emoji">${c.e}</div>
   <div class="name">${c.n}</div>
   <div class="prompt">Sodium level?</div>
  </div>
  ${c.p?c.p.map(x=>'<div class="part">'+x+'</div>').join(""):""}
 `;
 stack.appendChild(el);
}

function feedback(ok,c){
 toast.style.display="block";
 toast.innerHTML=`<b>${ok?"âœ… Correct":"âŒ Not quite"}</b><br/>${c.t}<br/><i>${ok?"Youâ€™re building sodium instincts.":"Youâ€™ll spot this faster next time."}</i>`;
}

function answer(choice){
 if(busy) return; busy=true;
 const c=round[idx]; const ok=choice===c.c;
 if(ok) correct++;
 feedback(ok,c);
 setTimeout(()=>{
   idx++; busy=false;
   if(idx>=10) endLevel();
   else render();
 },FEEDBACK);
}

function endLevel(){
 modal.style.display="flex";
 const passed=correct>=PASS;
 if(level===5){
   panel.innerHTML=`<h2>ğŸ‰ Guru Achieved</h2>
   <p>You completed all 5 levels.</p>
   <p><b>${correct}/10</b> correct on the final level.</p>
   <p>You now recognize smart meals and sodium traps in the real world.</p>
   <button onclick="restart()">Play Again</button>`;
 } else {
   panel.innerHTML=`<h2>${passed?"Level Up ğŸ‰":"Try Again ğŸ”"}</h2>
   <p>Score: <b>${correct}/10</b></p>
   <p>${passed?"Welcome to "+RANKS[level]+".":"Youâ€™re close â€” repeat to advance."}</p>
   <button onclick="next(${passed})">${passed?"Next Level":"Retry"}</button>`;
 }
}

function next(p){modal.style.display="none"; if(p) level++; start();}
function restart(){modal.style.display="none"; level=1; start();}
function start(){round=buildRound(); idx=0; correct=0; render();}
document.querySelectorAll(".toggle").forEach(t=>{
 t.onclick=()=>{const c=t.dataset.c; if(c==="all"){Object.keys(cuisines).forEach(k=>cuisines[k]=true);}
 else cuisines[c]=!cuisines[c]; t.classList.toggle("on");}
});
start();
</script>
</body>
</html>
